import{c as R,u as d,r as A,e as m,A as p}from"./index-937124d3.js";import{c as l,d as v,u as h,a as O}from"./index-bfbcd454.js";const u=(t,o)=>{const e=new Date(t),s=new Date(o);return e.valueOf()-s.valueOf()},T=(t,o)=>u(t.primeiraDataDisponivel,o.primeiraDataDisponivel),N=t=>t==null?void 0:t.map(o=>{var s,a;const e=o.datasAtendimento.sort(u);return{id:o.id,endereco:{cep:(s=o.cep)==null?void 0:s.toString(),logradouro:o.enderecoAgencia,uf:o.ufAgencia,municipio:o.municipioAgencia,numeroLogradouro:(a=o.numeroAgencia)==null?void 0:a.toString()},nome:o.nomeAgencia,datasDisponiveis:e,primeiraDataDisponivel:e[0]}}).sort(T),I=()=>{const[t,o]=R(l),{data:e,error:s,loading:a,fetchFunction:r}=d({endpoint:p.OBTER_UNIDADES,method:"GET"});A.useEffect(()=>{t||r()},[r,t]);const n=N(e);return A.useEffect(()=>{o(i=>i||(n??null))},[o,n]),{unidades:n??t,error:s,loading:a}},C=()=>{const t=m(v),o=m(h),e=m(O),{error:s,loading:a,success:r,fetchFunction:n}=d({endpoint:p.CRIAR_REQUERENTE,method:"POST",initLoading:!0}),{data:i,error:f,loading:D,success:E,fetchFunction:g}=d({endpoint:p.CRIAR_AGENDAMENTO,method:"POST"});return A.useEffect(()=>{n(t??void 0).then(c=>{c!=null&&c.cpf&&e&&(o!=null&&o.id)&&g({cpfRequerente:c==null?void 0:c.cpf,dataHoraAgendamento:e,numeroAgencia:o==null?void 0:o.id,servico:"AGENDAMENTO"})})},[g,n,t,e,o==null?void 0:o.id]),{agendamento:i,loading:a||D,success:r&&E,error:s||f}};export{C as a,I as u};
